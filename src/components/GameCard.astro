---
interface Props {
  titleKey: string
  descriptionKey: string
  image: string
  href: string
  platforms?: ('steam' | 'switch')[]
  leftMemoTextKey?: string
  leftMemoColor?: string
  rightMemoTextKey?: string
  rightMemoColor?: string
  haveDetailPage?: boolean
  r18?: boolean
}

const { titleKey, descriptionKey, image, href, platforms = [], leftMemoTextKey, leftMemoColor = '#FFE680', rightMemoTextKey, rightMemoColor = '#FFE680', haveDetailPage = true, r18 = false } = Astro.props

const WrapperTag = haveDetailPage ? 'a' : 'div'
const wrapperProps = haveDetailPage ? { href } : {}
---

<WrapperTag {...wrapperProps} class="group block relative">
  <!-- 右側 Memo 便條紙 -->
  {rightMemoTextKey && (
    <div 
      class="absolute -top-2 -right-2 z-10 px-3 py-1.5 text-xs font-bold text-gray-800 shadow-md transform border-2 border-white rounded-lg"
      style={`
          background-color: ${rightMemoColor}; 
          box-shadow: 0 0 0 3px ${rightMemoColor}, 5px 5px 0px 2px rgba(0, 0, 0, .2);`}
      data-i18n={rightMemoTextKey}
    >
    </div>
  )}

  <article class="bg-gray-100 rounded-2xl overflow-hidden border border-gray-300 hover:border-blue-400/50 transition-all duration-300 hover:shadow-lg hover:shadow-blue-400/10 relative"
     style="box-shadow: 0px 0px 5px 0px rgba(0, 0, 0, 0.25);">

    <!-- Image -->
    <div class="relative aspect-video overflow-hidden">
      <img 
        src={image} 
        alt={titleKey}
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
      />
      <div class="absolute inset-0 bg-gradient-to-t from-gray-100 via-transparent to-transparent opacity-60" />
      
      <!-- R18 圖標 -->
      {r18 && (
        <div class="absolute bottom-2 right-2 z-10">
          <img src="/images/icon/ja_r18.png" alt="R18" class="w-12 h-12 opacity-90" />
        </div>
      )}
      
      <!-- 左側 Memo 便條紙 -->
      {leftMemoTextKey && (
        <div 
          class="absolute bottom-0 left-0 z-10 px-3 py-1.5 text-xs font-bold text-gray-800 shadow-md transform rounded-tr-lg"
          style={`background-color: ${leftMemoColor}; box-shadow: 3px -3px 5px 0px rgba(0, 0, 0, .2);`}
          data-i18n={leftMemoTextKey}
        >
        </div>
      )}
    </div>

    <!-- Content -->
    <div class="px-6 pt-2 pb-5">
      <!-- Title -->
      <h3 class="text-xl font-bold text-gray-900 mb-0 group-hover:text-blue-500 transition-colors" data-i18n={titleKey}>
      </h3>

      <!-- Description -->
      <p class="text-gray-600 text-sm line-clamp-2 ml-[3px] mt-[3px]" data-i18n={descriptionKey}>
      </p>

      <!-- Platform Logos -->
      {platforms.length > 0 && (
        <div class="mt-[20px] ml-[5px] flex gap-4">
          {platforms.includes('steam') && (
            <!-- Steam Logo -->
            <div class="inline-flex flex-col items-center gap-0.5">
              <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor">
                <path d="M11.979 0C5.678 0 .511 4.86.022 11.037l6.432 2.658c.545-.371 1.203-.59 1.912-.59.063 0 .125.004.188.006l2.861-4.142V8.91c0-2.495 2.028-4.524 4.524-4.524 2.494 0 4.524 2.031 4.524 4.527s-2.03 4.525-4.524 4.525h-.105l-4.076 2.911c0 .052.004.105.004.159 0 1.875-1.515 3.396-3.39 3.396-1.635 0-3.016-1.173-3.331-2.727L.436 15.27C1.862 20.307 6.486 24 11.979 24c6.627 0 11.999-5.373 11.999-12S18.605 0 11.979 0zM7.54 18.21l-1.473-.61c.262.543.714.999 1.314 1.25 1.297.539 2.793-.076 3.332-1.375.263-.63.264-1.319.005-1.949s-.75-1.121-1.377-1.383c-.624-.26-1.29-.249-1.878-.03l1.523.63c.956.4 1.409 1.5 1.009 2.455-.397.957-1.497 1.41-2.454 1.012H7.54zm9.423-11.375c-1.661 0-3.01 1.35-3.01 3.012s1.347 3.011 3.01 3.011 3.01-1.349 3.01-3.01-1.346-3.012-3.01-3.012zm0 4.772c-.974 0-1.762-.79-1.762-1.762s.789-1.763 1.762-1.763c.971 0 1.762.791 1.762 1.763s-.79 1.762-1.762 1.762z"/>
              </svg>
              <span class="text-gray-700 text-[10px] font-medium">Steam</span>
            </div>
          )}

          {platforms.includes('switch') && (
            <!-- Switch Logo -->
            <div class="inline-flex flex-col items-center gap-0.5">
              <img src="/images/icon/switch-logo.svg" alt="Switch" class="w-8 h-8" />
              <span class="text-gray-700 text-[10px] font-medium">Switch</span>
            </div>
          )}
        </div>
      )}

    </div>
  </article>
</WrapperTag>
